---
import { serviceList } from "../data/diensten";
import { localize, type Lang } from "../i18n";
import { ui } from "../data/ui";

interface Props {
    related: string[];
    lang: Lang;
}

const { related, lang } = Astro.props as Props;
const relatedItems = related
    .map((slug) => {
        const listIndex = serviceList.findIndex((item) => item.slug === slug);
        if (listIndex < 0) return null;
        return { item: serviceList[listIndex], listIndex };
    })
    .filter(
        (entry): entry is { item: (typeof serviceList)[number]; listIndex: number } =>
            Boolean(entry),
    )
    .slice(0, 3);
---

<section>
    <h2 class="text-2xl font-bold text-secondary md:text-3xl">
        <span data-i18n="ui.common.relatedServices">
            {localize(ui.common.relatedServices, lang)}
        </span>
    </h2>
    <div class="mt-4 grid gap-4 md:grid-cols-3">
        {
            relatedItems.map((entry) => (
                <a
                    href={entry.item.href}
                    class="block rounded-2xl border border-secondary/20 bg-white p-4 transition hover:border-secondary/45"
                >
                    <h3 class="text-base font-semibold text-secondary">
                        <span data-i18n={`diensten.list.${entry.listIndex}.title`}>
                            {localize(entry.item.title, lang)}
                        </span>
                    </h3>
                    <p class="mt-2 text-sm text-text">
                        <span
                            data-i18n={`diensten.list.${entry.listIndex}.excerpt`}
                        >
                            {localize(entry.item.excerpt, lang)}
                        </span>
                    </p>
                </a>
            ))
        }
    </div>
</section>
