---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Hero from "../../../components/Hero.astro";
import CTASection from "../../../components/CTASection.astro";
import ServiceCards from "../../../components/ServiceCards.astro";
import ProcessStrip from "../../../components/ProcessStrip.astro";
import {
    services,
    strippenkaartLowestVariant,
} from "../../../data/diensten/oppas-uitlaatservice/index";
import { page } from "../../../data/diensten/oppas-uitlaatservice/index";
import { localize, resolveLangFromUrl } from "../../../i18n";
import { ui } from "../../../data/ui";

const lang = resolveLangFromUrl(Astro.url);
---

<BaseLayout
    title={localize(page.seo.title, lang)}
    description={localize(page.seo.description, lang)}
>
    <Hero
        title={localize(page.hero.title, lang)}
        subtitle={localize(page.hero.subtitle, lang)}
        titleKey="oppas.page.hero.title"
        subtitleKey="oppas.page.hero.subtitle"
        imageSrc={page.hero.imageSrc}
        imageAlt={localize(page.hero.imageAlt, lang)}
        imageAltKey="oppas.page.hero.imageAlt"
        primaryCta={{
            label: localize(ui.common.chooseService, lang),
            href: "#diensten",
        }}
        primaryCtaLabelKey="ui.common.chooseService"
        secondaryCta={{
            label: localize(page.hero.secondaryCta.label, lang),
            href: page.hero.secondaryCta.href,
        }}
        secondaryCtaLabelKey="oppas.page.hero.secondaryCta.label"
    />

    <section class="py-12 md:py-16">
        <div class="mx-auto w-full max-w-6xl px-4 md:px-6">
            <div
                class="rounded-3xl border border-main/40 bg-main-soft p-8 shadow-sm md:p-10"
            >
                <h2
                    class="text-3xl font-bold tracking-tight text-secondary md:text-4xl"
                >
                    <span data-i18n="oppas.page.intro.title"
                        >{localize(page.intro.title, lang)}</span
                    >
                </h2>
                <p
                    class="mt-4 text-lg md:text-xl font-medium text-main-dark/90 max-w-3xl"
                >
                    <span data-i18n="oppas.page.intro.lead"
                        >{localize(page.intro.lead, lang)}</span
                    >
                </p>
                {
                    page.intro.paragraphs.map((paragraph, index) => (
                        <p class="mt-3 text-text">
                            <span
                                data-i18n={`oppas.page.intro.paragraphs.${index}`}
                            >
                                {localize(paragraph, lang)}
                            </span>
                        </p>
                    ))
                }

                <ul class="mt-5 grid gap-3 md:grid-cols-2">
                    {
                        page.intro.bullets.map((bullet, index) => (
                            <li class="rounded-xl border border-secondary/20 bg-white px-4 py-3 text-text">
                                <span
                                    data-i18n={`oppas.page.intro.bullets.${index}`}
                                >
                                    {localize(bullet, lang)}
                                </span>
                            </li>
                        ))
                    }
                </ul>
            </div>
        </div>
    </section>

    <ServiceCards
        sectionId="diensten"
        title={localize(page.cards.title, lang)}
        titleKey="oppas.page.cards.title"
        variant="priced"
        actionLink={{
            label: localize(page.cards.actionLink.label, lang),
            href: page.cards.actionLink.href,
        }}
        actionLinkLabelKey="oppas.page.cards.actionLink.label"
        items={services.map((service, index) => ({
            title: localize(service.shortTitle, lang),
            description: localize(service.shortDescription, lang),
            href: service.href,
            ctaLabel: localize(page.cards.cardCtaLabel, lang),
            priceLabel:
                service.slug === "strippenkaart"
                    ? `v.a. ${localize(strippenkaartLowestVariant.priceLabel, lang)}`
                    : localize(service.priceLabel, lang),
            headerTone: index % 2 === 0 ? "secondary" : "main",
            titleKey: `oppas.page.services.${index}.shortTitle`,
            descriptionKey: `oppas.page.services.${index}.shortDescription`,
            ctaLabelKey: "oppas.page.cards.cardCtaLabel",
        }))}
    />

    <section class="py-6 md:py-8">
        <div class="mx-auto w-full max-w-6xl px-4 md:px-6">
            <div
                class="rounded-3xl border border-main/40 bg-main-soft p-8 shadow-sm md:p-10"
            >
                <h2
                    class="text-3xl font-bold tracking-tight text-secondary md:text-4xl"
                >
                    <span data-i18n="oppas.page.process.title"
                        >{localize(page.process.title, lang)}</span
                    >
                </h2>
                <p
                    class="mt-4 text-lg md:text-xl font-medium text-main-dark/90 max-w-3xl"
                >
                    <span data-i18n="oppas.page.process.lead"
                        >{localize(page.process.lead, lang)}</span
                    >
                </p>

                <ProcessStrip
                    cardsOnly={true}
                    items={page.process.items.map((item, index) => ({
                        ...item,
                        title: localize(item.title, lang),
                        text: localize(item.text, lang),
                        titleKey: `oppas.page.process.items.${index}.title`,
                        textKey: `oppas.page.process.items.${index}.text`,
                    }))}
                />
            </div>
        </div>
    </section>

    <section class="py-6 md:py-8">
        <div class="mx-auto w-full max-w-6xl px-4 md:px-6">
            <div class="rounded-3xl border border-main/25 bg-white p-6 md:p-8">
                <div class="grid gap-8 md:grid-cols-12">
                    <div class="md:col-span-5">
                        <h2
                            class="text-3xl font-bold tracking-tight text-secondary md:text-4xl"
                        >
                            <span data-i18n="oppas.page.scenarios.title"
                                >{localize(page.scenarios.title, lang)}</span
                            >
                        </h2>
                        <p
                            class="mt-4 text-lg md:text-xl font-medium text-main-dark/90 max-w-3xl"
                        >
                            <span data-i18n="oppas.page.scenarios.lead"
                                >{localize(page.scenarios.lead, lang)}</span
                            >
                        </p>
                        <div class="mt-4 flex flex-wrap gap-2">
                            {
                                page.scenarios.chips.map((chip, index) => (
                                    <span class="rounded-full border border-secondary/20 bg-secondary-soft/70 px-3 py-1 text-xs font-semibold text-detail">
                                        <span
                                            data-i18n={`oppas.page.scenarios.chips.${index}`}
                                        >
                                            {localize(chip, lang)}
                                        </span>
                                    </span>
                                ))
                            }
                        </div>
                    </div>

                    <div class="md:col-span-7 space-y-4">
                        {
                            page.scenarios.items.map((item, index) => {
                                const isExternal = item.external === true;
                                return (
                                    <article class="rounded-2xl border border-secondary/20 bg-secondary-soft/45 p-5">
                                        <h3 class="text-xl font-bold text-secondary">
                                            <span
                                                data-i18n={`oppas.page.scenarios.items.${index}.title`}
                                            >
                                                {localize(item.title, lang)}
                                            </span>
                                        </h3>
                                        <p class="mt-2 text-text">
                                            <span
                                                data-i18n={`oppas.page.scenarios.items.${index}.textBeforeLink`}
                                            >
                                                {localize(
                                                    item.textBeforeLink,
                                                    lang,
                                                )}
                                            </span>
                                            <a
                                                href={item.linkHref}
                                                target={
                                                    isExternal
                                                        ? "_blank"
                                                        : undefined
                                                }
                                                rel={
                                                    isExternal
                                                        ? "noopener noreferrer"
                                                        : undefined
                                                }
                                                class="font-semibold text-secondary underline decoration-2 underline-offset-2 hover:text-detail focus:outline-none focus-visible:ring-2 focus-visible:ring-main"
                                            >
                                                <span
                                                    data-i18n={`oppas.page.scenarios.items.${index}.linkLabel`}
                                                >
                                                    {localize(
                                                        item.linkLabel,
                                                        lang,
                                                    )}
                                                </span>
                                            </a>
                                            <span
                                                data-i18n={`oppas.page.scenarios.items.${index}.textAfterLink`}
                                            >
                                                {localize(
                                                    item.textAfterLink,
                                                    lang,
                                                )}
                                            </span>
                                        </p>
                                    </article>
                                );
                            })
                        }

                        <div class="pt-1 flex flex-wrap gap-2">
                            {
                                page.scenarios.ctas.map((cta, index) => {
                                    const isExternal = cta.external === true;
                                    return (
                                        <a
                                            href={cta.href}
                                            target={
                                                isExternal
                                                    ? "_blank"
                                                    : undefined
                                            }
                                            rel={
                                                isExternal
                                                    ? "noopener noreferrer"
                                                    : undefined
                                            }
                                            class:list={[
                                                "inline-flex items-center rounded-full px-4 py-2 text-sm font-semibold transition focus:outline-none focus-visible:ring-2 focus-visible:ring-main",
                                                index === 0
                                                    ? "border border-secondary bg-white text-secondary hover:bg-secondary-soft"
                                                    : "border border-secondary/30 bg-secondary-soft/60 text-secondary hover:bg-secondary-soft",
                                            ]}
                                            data-i18n={`oppas.page.scenarios.ctas.${index}.label`}
                                        >
                                            {localize(cta.label, lang)}
                                        </a>
                                    );
                                })
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <CTASection
        title={localize(page.cta.title, lang)}
        text={localize(page.cta.text, lang)}
        titleKey="oppas.page.cta.title"
        textKey="oppas.page.cta.text"
        primary={{
            label: localize(page.cta.primary.label, lang),
            href: page.cta.primary.href,
        }}
        primaryLabelKey="oppas.page.cta.primary.label"
        secondary={{
            label: localize(page.cta.secondary.label, lang),
            href: page.cta.secondary.href,
        }}
        secondaryLabelKey="oppas.page.cta.secondary.label"
    />
</BaseLayout>
