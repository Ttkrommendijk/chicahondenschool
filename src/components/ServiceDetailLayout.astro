---
import BaseLayout from "../layouts/BaseLayout.astro";
import PriceCTABox from "./PriceCTABox.astro";
import { getLangFromUrl, localize } from "../i18n";
import { ui } from "../data/ui";

interface ServiceDetailData {
    title: string;
    tagline: string;
    intro: string;
    description: string;
    outcomes: string[];
    duration: string;
    durationShort: string;
    locations: string[];
    forWho: string;
    price: string;
    purchaseLinks: { label: string; href: string; external?: boolean }[];
    image: string;
    imageAlt: string;
    seoTitle: string;
    seoDescription: string;
}

interface Props {
    service: ServiceDetailData;
    categoryLabel?: string;
}

const lang = getLangFromUrl(Astro.url);
const { service, categoryLabel = localize(ui.navigation.dogTraining, lang) } =
    Astro.props as Props;
---

<BaseLayout title={service.seoTitle} description={service.seoDescription}>
    <section class="bg-gradient-to-b from-main-soft to-white py-14 md:py-20">
        <div
            class="mx-auto grid w-full max-w-6xl gap-8 px-4 md:grid-cols-2 md:items-center md:px-6"
        >
            <div>
                <p
                    class="inline-flex rounded-full border border-main bg-white px-3 py-1 text-xs font-semibold uppercase tracking-wide text-detail"
                >
                    {categoryLabel}
                </p>
                <h1
                    class="mt-3 text-4xl font-extrabold leading-tight text-secondary md:text-5xl"
                >
                    {service.title}
                </h1>
                <p class="mt-4 max-w-2xl text-lg text-text">
                    {service.tagline}
                </p>
            </div>
            <div class="relative">
                <div class="absolute -inset-3 rounded-3xl bg-main/40 blur-xl">
                </div>
                <img
                    src={service.image}
                    alt={service.imageAlt}
                    class="relative h-full w-full rounded-3xl border border-main object-cover shadow-xl"
                    loading="eager"
                />
            </div>
        </div>
    </section>

    <section class="py-12 md:py-16">
        <div
            class="mx-auto grid w-full max-w-6xl gap-8 px-4 md:grid-cols-[minmax(0,2fr)_minmax(300px,1fr)] md:px-6"
        >
            <div class="space-y-8">
                <div
                    class="rounded-3xl border border-secondary/20 bg-white p-7 shadow-sm"
                >
                    <h2 class="text-2xl font-bold text-secondary md:text-3xl">
                        {localize(ui.serviceDetail.whyWorks, lang)}
                    </h2>
                    <p class="mt-3 text-text">{service.intro}</p>
                    <p class="mt-3 text-text">{service.description}</p>
                </div>

                <div class="rounded-3xl border border-main bg-main-soft p-7">
                    <h2 class="text-2xl font-bold text-secondary md:text-3xl">
                        {localize(ui.serviceDetail.outcomes, lang)}
                    </h2>
                    <ul class="mt-4 space-y-2">
                        {
                            service.outcomes.map((item) => (
                                <li class="rounded-xl bg-white px-3 py-2 text-text">
                                    {item}
                                </li>
                            ))
                        }
                    </ul>
                </div>

                <div
                    class="rounded-3xl border border-secondary/25 bg-secondary-soft p-7"
                >
                    <h2 class="text-2xl font-bold text-secondary md:text-3xl">
                        {localize(ui.serviceDetail.practical, lang)}
                    </h2>
                    <dl class="mt-4 space-y-4">
                        <div>
                            <dt
                                class="text-sm font-semibold uppercase tracking-wide text-detail"
                            >
                                {localize(ui.serviceDetail.duration, lang)}
                            </dt>
                            <dd class="text-text">{service.duration}</dd>
                        </div>
                        <div>
                            <dt
                                class="text-sm font-semibold uppercase tracking-wide text-detail"
                            >
                                {localize(ui.serviceDetail.location, lang)}
                            </dt>
                            <dd class="text-text">
                                {service.locations.join(", ")}
                            </dd>
                        </div>
                        <div>
                            <dt
                                class="text-sm font-semibold uppercase tracking-wide text-detail"
                            >
                                {localize(ui.serviceDetail.forWho, lang)}
                            </dt>
                            <dd class="text-text">{service.forWho}</dd>
                        </div>
                    </dl>
                </div>

                <slot name="extra" />
            </div>

            <div class="md:sticky md:top-24 md:self-start">
                <PriceCTABox
                    price={service.price}
                    durationShort={service.durationShort}
                    locations={service.locations}
                    purchaseLinks={service.purchaseLinks}
                />
            </div>
        </div>
    </section>

    <section class="pb-14 md:pb-20">
        <div class="mx-auto w-full max-w-6xl px-4 md:px-6">
            <div
                class="rounded-3xl border border-main/40 bg-gradient-to-r from-main-soft to-secondary-soft p-8"
            >
                <h2 class="text-2xl font-bold text-secondary md:text-3xl">
                    {localize(ui.serviceDetail.doubtTitle, lang)}
                </h2>
                <p class="mt-3 max-w-3xl text-text">
                    {localize(ui.serviceDetail.doubtText, lang)}
                </p>
                <div class="mt-5 flex flex-wrap gap-3">
                    <a
                        href="/contact/"
                        class="inline-flex items-center rounded-full bg-secondary px-6 py-3 text-sm font-semibold text-white transition hover:bg-secondary-hover focus:outline-none focus-visible:ring-2 focus-visible:ring-main"
                    >
                        {localize(ui.contentLayout.contactCta, lang)}
                    </a>
                    <a
                        href={ui.links.bookingUrl}
                        target="_blank"
                        rel="noreferrer noopener"
                        class="inline-flex items-center rounded-full border border-secondary bg-white px-6 py-3 text-sm font-semibold text-secondary transition hover:bg-secondary-soft focus:outline-none focus-visible:ring-2 focus-visible:ring-main"
                    >
                        {localize(ui.common.bookNow, lang)}
                    </a>
                </div>
            </div>
        </div>
    </section>
</BaseLayout>
